<?phpclass C_login extends Controller {    // Login Index    public function index()    {        if($_SERVER['REQUEST_METHOD'] == 'POST')        {            extract($_POST);                        // E-Posta ve şifre boş ise            if( empty($email) || empty($password) )            {                $this->msg->add('w', $this->data['LANG']['LOGIN_EMPTY_DATA']);                $this->system->route('admin', 'login');              }                        // Şifre 6 karakterden az ise            if( strlen($password) < 6 )            {                $this->msg->add('w', $this->data['LANG']['LOGIN_ERROR_PASSWORD']);                $this->system->route('admin', 'login');              }                        // E-Posta adresi hatalı ise            if( filter_var($email, FILTER_VALIDATE_EMAIL) == false )            {                $this->msg->add('w', $this->data['LANG']['LOGIIN_ERROR_INVALID_MAIL']);                $this->system->route('admin', 'login');              }                        $email      = trim($email);            $password   = sha1(trim($password));            $count      = $this->model->getUserCount($email, $password);            if($count == 1)            {                $user_detail = $this->model->getUserDetail($email, $password);                if( $password == $user_detail['password'] && $email == $user_detail['email'] )                {                       if($this->model->createSession($user_detail['id']))                    {                        setcookie("user_id", $user_detail['id'], time()+3600, '/');                        setcookie("email", $user_detail['email'], time()+3600, '/');                        setcookie("fullname", $user_detail['fullname'], time()+3600, '/');                                                $this->system->route('admin', 'home');                    }                    else                    {                        $this->msg->add('w', 'Oturum açılırken sorun oluştu.');                        $this->system->route('admin', 'login');                    }                }                else                {                    $this->msg->add('w', 'Kullanıcı girişi hatalı.');                    $this->system->route('admin', 'login');                }            }            else            {                $this->msg->add('w', 'Kullanıcı bulunamadı.');                $this->system->route('admin', 'login');            }        }                $this->load->view('login', 'index', $this->data);    }        public function logout()    {        setcookie("user_id", '', time()-2000, '/');        setcookie("email", '', time()-2000, '/');        setcookie("fullname", '', time()-2000, '/');        $this->system->route('admin', 'login');    }    public function noaccess()    {        $this->load->view('login','noaccess');    }}